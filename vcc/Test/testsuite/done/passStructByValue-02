
#include <vcc.h>

typedef struct proc_t {
    unsigned int gpr[32];    
    unsigned int spr[17];    
    unsigned int dpc;        
    unsigned int pcp;        
} proc_t;

spec(
ispure   bool post(proc_t proc, proc_t oldproc) 
    ensures(result == (proc.dpc == oldproc.pcp && proc.pcp == unchecked(oldproc.pcp + 4)));
)    

void f(proc_t *proc)
  requires(_vcc_mutable(proc))
  ensures(post(*proc, old(*proc)))
  writes(_vcc_extent(proc))
{
  proc->dpc = proc->pcp;
  proc->pcp = unchecked(proc->pcp +4);
}
`
Verification of f succeeded.
`
