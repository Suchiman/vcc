#include <vcc.h>

struct Node {
    struct Node *next;

    invariant( depends(owner(this), this) )
};


typedef struct Node *PNode;
struct Stack {
    volatile PNode hd;
};

bool push(struct Node *n, struct Stack *s claimp(c))
    always (c, closed(s))
    requires (mutable(n) && owns(n) == set_empty())
    writes (n, n->next)
{
	atomic(c) {
            set_closed_owner(n, s);

	}
}
`
Verification of Node#adm succeeded.
Verification of push failed.
testcase(21,13) : error VC8532: Assertion 's is atomically updated in call to _vcc_set_closed_owner(n, s)' did not verify.
`
