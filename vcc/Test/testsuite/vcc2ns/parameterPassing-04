#include <vcc.h>

void foo(int *p)
  out_param(p)
{
  *p = 10;
}

void foo_w(int *p)
  weak_out_param(p)
{
  *p = 10;
}

struct A { int x; };

void bar(struct A *a)
  out_param(a);

int baz()
{
  int x;
  struct A a;
  foo(&x);
  bar(&a);
  return x;
}

void fail1()
{
  struct A a;
  foo(&a.x);
}

void ok1()
{
  struct A a;
  foo_w(&a.x);
}
`
Verification of foo succeeded.
Verification of foo_w succeeded.
Verification of baz succeeded.
Verification of fail1 failed.
testcase(32,3) : error VC9502: Call 'foo(&a.x)' did not verify.
testcase(4,45) : error VC9599: (related information) Precondition: '_vcc_is_object_root(p)'.
Verification of ok1 succeeded.
`
