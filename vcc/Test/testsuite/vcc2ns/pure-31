#include <vcc.h>

ispure int foo(int *i)
  reads(i)
  requires(thread_local(i))
  ensures(result == *i);
  
void bar(int *i)
  writes(i)
  requires(thread_local(i))
{
  int p = 1;
  int j;
  *i = 0;
  p = j && old(foo(i));
  assert(j && old(*i) ==> p);
}
`
Verification of bar succeeded.
Verification of foo#reads succeeded.
`
