#include "vcc.h"

typedef struct s1{
    int dummy;
} s1;

typedef struct vcc(dynamic_owns) q1{
    bool b;
    s1 *s;
    invariant(b ==> keeps(s))
}q1;

void f(q1 *q)
requires(!q->b)
requires(wrapped(q))
writes(q)
{
    unwrap(q);
    giveup_owner(q->s, q);
}
`
Verification of q1#adm succeeded.
Verification of f failed.
testcase(19,19) : error VC9500: Assertion '_vcc_set_in(q->s,_vcc_owns(q))' did not verify.
`
